scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.08, y = 0.08, label = "nematodes")
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.08, y = 0.2, label = "nematodes")
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.18, y = 0.2, label = "nematodes")
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.15, y = 0.2, label = "nematodes")
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.12, y = 0.2, label = "nematodes")
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.13, y = 0.2, label = "nematodes")
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.14, y = 0.2, label = "nematodes")
# Principal Coordinates Analysis Mgmt*Date
pcoa.groups <- paste(nemaREL$Management, nemaREL$Date, sep = "_")
pcoa.points <- data.frame(pcoa$points, group = pcoa.groups)
# Calculate Centroids (mean and SE)
pcoa.L.centroids <- melt(pcoa.points, id="group", measure.vars = c("X1", "X2"))
pcoa.centroids <- acast(pcoa.L.centroids, variable ~ group, mean)
pcoa.centroids.se <- acast(pcoa.L.centroids, variable ~ group, se)
pcoa.centroids.sd <- acast(pcoa.L.centroids, variable ~ group, sd)
# Combine
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Date
# Principal Coordinates Analysis (Mgmt*Date)
df3a <- as.data.frame(pcoa.cent.dataframe)
plot3a <- ggplot(df3a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot3a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600")) +
scale_fill_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600"))  +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Date", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.08, y = 0.09, label = "nematodes")
ggsave("../figures/nema_PWES_YrMgmt.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=900, limitsize=TRUE)
# Principal Coordinates Analysis (Mgmt*Plant)
pcoa.groups <- paste(nemaREL$Management, nemaREL$Plant, sep = "_")
pcoa.points <- data.frame(pcoa$points, group = pcoa.groups)
# Calculate Centroids (mean and SE)
pcoa.L.centroids <- melt(pcoa.points, id="group", measure.vars = c("X1", "X2"))
pcoa.centroids <- acast(pcoa.L.centroids, variable ~ group, mean)
pcoa.centroids.se <- acast(pcoa.L.centroids, variable ~ group, se)
pcoa.centroids.sd <- acast(pcoa.L.centroids, variable ~ group, sd)
# Combine
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Plant
#Plot
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.14, y = 0.2, label = "nematodes")
ggsave("../figures/nema_PlantMgmt.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=900, limitsize=TRUE)
# Principal Coordinates Analysis
dataREL.dist <- vegdist(dataRELnema, method="bray")
pcoa <- cmdscale(dataREL.dist, k=3, eig=TRUE, add=FALSE)
# Classical (Metric) Multidimensional Scaling; returns PCoA coordinates
# eig=TRUE returns eigenvalues; k = # of dimensions to calculate
explainvar1b <- round(pcoa$eig[1] / sum(pcoa$eig), 3) * 100
explainvar2b <- round(pcoa$eig[2] / sum(pcoa$eig), 3) * 100
sum.eigb <- sum(explainvar1b, explainvar2b)
explainvar1b #19.8
explainvar2b #18.3
# Principal Coordinates Analysis Mgmt*Date
pcoa.groups <- paste(nemaREL$Management, nemaREL$Date, sep = "_")
pcoa.points <- data.frame(pcoa$points, group = pcoa.groups)
# Calculate Centroids (mean and SE)
pcoa.L.centroids <- melt(pcoa.points, id="group", measure.vars = c("X1", "X2"))
pcoa.centroids <- acast(pcoa.L.centroids, variable ~ group, mean)
pcoa.centroids.se <- acast(pcoa.L.centroids, variable ~ group, se)
pcoa.centroids.sd <- acast(pcoa.L.centroids, variable ~ group, sd)
# Combine
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Date
# Principal Coordinates Analysis (Mgmt*Date)
df3a <- as.data.frame(pcoa.cent.dataframe)
plot3a <- ggplot(df3a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot3a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600")) +
scale_fill_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600"))  +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Date", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.08, y = 0.09, label = "nematodes")
ggsave("../figures/nema_PWES_YrMgmt.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=900, limitsize=TRUE)
# Principal Coordinates Analysis (Mgmt*Plant)
pcoa.groups <- paste(nemaREL$Management, nemaREL$Plant, sep = "_")
pcoa.points <- data.frame(pcoa$points, group = pcoa.groups)
# Calculate Centroids (mean and SE)
pcoa.L.centroids <- melt(pcoa.points, id="group", measure.vars = c("X1", "X2"))
pcoa.centroids <- acast(pcoa.L.centroids, variable ~ group, mean)
pcoa.centroids.se <- acast(pcoa.L.centroids, variable ~ group, se)
pcoa.centroids.sd <- acast(pcoa.L.centroids, variable ~ group, sd)
# Combine
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Plant
#Plot
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.14, y = 0.2, label = "nematodes")
ggsave("../figures/nema_PlantMgmt.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=900, limitsize=TRUE)
# Principal Coordinates Analysis
dataREL.dist <- vegdist(dataRELnema, method="bray")
pcoa <- cmdscale(dataREL.dist, k=3, eig=TRUE, add=FALSE)
explainvar1b <- round(pcoa$eig[1] / sum(pcoa$eig), 3) * 100
explainvar2b <- round(pcoa$eig[2] / sum(pcoa$eig), 3) * 100
sum.eigb <- sum(explainvar1b, explainvar2b)
explainvar1b #19.8
explainvar2b #18.3
# Principal Coordinates Analysis Mgmt*Date
pcoa.groups <- paste(nemaREL$Management, nemaREL$Date, sep = "_")
pcoa.points <- data.frame(pcoa$points, group = pcoa.groups)
# Calculate Centroids (mean and SE)
pcoa.L.centroids <- melt(pcoa.points, id="group", measure.vars = c("X1", "X2"))
pcoa.centroids <- acast(pcoa.L.centroids, variable ~ group, mean)
pcoa.centroids.se <- acast(pcoa.L.centroids, variable ~ group, se)
pcoa.centroids.sd <- acast(pcoa.L.centroids, variable ~ group, sd)
# Combine
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Date
df3a <- as.data.frame(pcoa.cent.dataframe)
plot3a <- ggplot(df3a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot3a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600")) +
scale_fill_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600"))  +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Date", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.08, y = 0.09, label = "nematodes")
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Date
# Principal Coordinates Analysis (Mgmt*Date)
df3a <- as.data.frame(pcoa.cent.dataframe)
plot3a <- ggplot(df3a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot3a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600")) +
scale_fill_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600"))  +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Date", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.12, y = 0.14, label = "nematodes")
ggsave("../figures/nema_PWES_YrMgmt.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=900, limitsize=TRUE)
pcoa.groups <- paste(nemaREL$Management, nemaREL$Date, sep = "_")
pcoa.points <- data.frame(pcoa$points, group = pcoa.groups)
# Calculate Centroids (mean and SE)
pcoa.L.centroids <- melt(pcoa.points, id="group", measure.vars = c("X1", "X2"))
pcoa.centroids <- acast(pcoa.L.centroids, variable ~ group, mean)
pcoa.centroids.se <- acast(pcoa.L.centroids, variable ~ group, se)
pcoa.centroids.sd <- acast(pcoa.L.centroids, variable ~ group, sd)
# Combine
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Date
# Principal Coordinates Analysis (Mgmt*Date)
df3a <- as.data.frame(pcoa.cent.dataframe)
plot3a <- ggplot(df3a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot3a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600")) +
scale_fill_manual(labels = c("2011","2012", "2013"),
values = c("#FFFFFF", "#FFFF00","#336600"))  +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Date", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.12, y = 0.14, label = "nematodes")
pcoa.groups <- paste(nemaREL$Management, nemaREL$Plant, sep = "_")
pcoa.points <- data.frame(pcoa$points, group = pcoa.groups)
# Calculate Centroids (mean and SE)
pcoa.L.centroids <- melt(pcoa.points, id="group", measure.vars = c("X1", "X2"))
pcoa.centroids <- acast(pcoa.L.centroids, variable ~ group, mean)
pcoa.centroids.se <- acast(pcoa.L.centroids, variable ~ group, se)
pcoa.centroids.sd <- acast(pcoa.L.centroids, variable ~ group, sd)
# Combine
pcoa.cent.dataframe <- cbind(t(pcoa.centroids), t(pcoa.centroids.se))
colnames(pcoa.cent.dataframe) <- c("V1", "V2", "V1e", "V2e")
pcoa.cent.treats <- rownames(pcoa.cent.dataframe)
pcoa.col <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 2)) # Management
pcoa.shape <- as.factor(sapply(strsplit(pcoa.cent.treats, "_"), `[`, 1))  # Plant
#Plot
df4a <- as.data.frame(pcoa.cent.dataframe)
plot4a <- ggplot(df4a, aes(x=V1, y=V2, colour=pcoa.col, shape = pcoa.shape,
group = interaction(pcoa.col, pcoa.shape))) + theme_bw()
plot4a + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(panel.background = element_blank()) +
geom_errorbarh(aes(xmax=V1+V1e, xmin=V1-V1e, height=0.01), colour="black") +
geom_errorbar(aes(ymax=V2+V2e, ymin=V2-V2e, width=0.01), colour="black") +
geom_point(aes(fill=pcoa.col), colour = "black", size=6, stroke = 0.75) +
scale_colour_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_fill_manual(labels = c("Annual","Perennial"),
values = c("orange", "blue")) +
scale_shape_manual(labels = c("HighN","LowN","Organic"),
values = c(22, 21, 24)) +
#coord_cartesian(xlim = c(-0.25, 0.5), ylim = c(-0.35, 0.3)) +
theme(axis.title = element_text(size=18), axis.text=element_text(size=14),
axis.text.x = element_text(size=14),
panel.border = element_rect(colour = "black", size=1.25)) +
theme(axis.ticks.length=unit(0.3,"cm")) +
xlab("PCoA 1 (19.8%)") + ylab("PCoA 2 (18.3%)") +
labs(fill = "Plant", shape = "Management") +
guides(fill = guide_legend(override.aes = list(pch=21, size = 4, colour="black")),
shape = guide_legend(override.aes = list(size = 4, fill="black"))) +
annotate("text", x = -0.14, y = 0.2, label = "nematodes")
ggsave("../figures/nema_PlantMgmt.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=900, limitsize=TRUE)
